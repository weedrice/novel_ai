# Next Tasks - 남은 작업 목록

> 프로젝트에서 아직 완료되지 않은 작업들
> 마지막 업데이트: 2025-11-04

---

## 📖 이 문서 사용 방법

- 완료된 작업은 [COMPLETED_TASKS.md](COMPLETED_TASKS.md)로 이동되었습니다
- 각 Phase는 선택적이며, 프로젝트 필요에 따라 진행하세요
- ⬜ 표시는 대기 중, ⏳은 진행 중을 의미합니다
- Task 완료 시마다 체크하여 진행 상황을 추적하세요

---

## 🎯 현재 상태 요약 (2025-11-04)

### ✅ 완료된 Phase
- Phase 0: 프로젝트 초기 설정
- Phase 1: 핵심 도메인 모델 및 데이터베이스 구축
- Phase 2: 캐릭터 관계 그래프 시각화
- Phase 3: 말투 프로필링 및 실제 LLM 연동
- Phase 4: 시나리오 제안 및 편집 기능
- Phase 5: 스크립트 검수 및 분석 도구
- Phase 6: 사용자 인증 및 권한 관리
- Phase 8: Docker 및 배포 자동화
- Phase 10: 고급 기능 및 최적화 (일부 완료 - Task 86-96)

### ⏳ 남은 Phase
- **Phase 7**: Vector DB 및 의미 검색 (선택적)
- **Phase 9**: Neo4j GraphDB 전환 (선택적)
- **Phase 10**: 추가 기능 (Task 97-100)

### 테스트 통계
- **백엔드**: 159개 통과 (Integration/Service tests)
- **프론트엔드**: 49개 (컴포넌트: 18, E2E: 31)
- **총 테스트**: 208개
- **커버리지**: Service 79%, Security 95%

### 알려진 이슈
- **Controller Tests**: 42개 @WebMvcTest 실패 (ApplicationContext 로딩 문제)
  - Spring Boot와 Redis/Cache 설정 간 충돌
  - 핵심 기능은 Integration/Service 테스트로 검증 완료
  - 향후 @WebMvcTest 설정 개선 필요

---

## Phase 7: Vector DB 및 의미 검색 (선택적)

### 목표
캐릭터 대사 및 장면 검색 시 의미 기반 검색 기능 추가

### 7.1 Pinecone/Weaviate/Qdrant 설정

#### Task 101: Vector DB 선택 및 설정
- [ ] Vector DB 선택 (Pinecone, Weaviate, Qdrant 중)
- [ ] Vector DB 클라이언트 라이브러리 추가
- [ ] 연결 설정 및 인덱스 생성
- [ ] 환경 변수 설정

**예상 소요 시간**: 1시간

---

#### Task 102: 임베딩 모델 연동
- [ ] OpenAI Embeddings API 또는 SentenceTransformers 연동
- [ ] 텍스트 → 벡터 변환 로직 구현
- [ ] 배치 임베딩 처리

**예상 소요 시간**: 2시간

---

### 7.2 의미 검색 기능 구현

#### Task 103: 대사 임베딩 저장
- [ ] 대사 생성 시 자동 임베딩 저장
- [ ] 기존 대사 일괄 임베딩
- [ ] 업데이트/삭제 시 벡터 동기화

**예상 소요 시간**: 2시간

---

#### Task 104: 의미 검색 API 구현
- [ ] 검색 쿼리 → 벡터 변환
- [ ] 유사도 기반 검색 (Cosine Similarity)
- [ ] 검색 결과 필터링 및 정렬
- [ ] GET /dialogues/search?q={query} 엔드포인트 구현

**예상 소요 시간**: 3시간

---

### 7.3 프론트엔드 검색 UI

#### Task 105: 검색 UI 구현
- [ ] 검색 바 컴포넌트
- [ ] 검색 결과 표시
- [ ] 검색 필터 (캐릭터, 에피소드 등)

**예상 소요 시간**: 2시간

---

**Phase 7 예상 소요 시간**: 8-10시간

---

## Phase 9: Neo4j GraphDB 전환 (선택적)

### 목표
캐릭터 관계를 Neo4j로 마이그레이션하여 복잡한 관계 쿼리 성능 향상

### 9.1 Neo4j 설정 및 연동

#### Task 106: Spring Data Neo4j 설정
- [ ] spring-boot-starter-data-neo4j 의존성 추가
- [ ] Neo4j 연결 설정 (application.properties)
- [ ] Neo4j 노드 및 관계 엔티티 정의

**예상 소요 시간**: 2시간

---

#### Task 107: 관계 데이터 마이그레이션
- [ ] PostgreSQL Relationship → Neo4j 관계 변환 스크립트
- [ ] 데이터 일괄 마이그레이션
- [ ] 데이터 무결성 검증

**예상 소요 시간**: 3시간

---

### 9.2 Neo4j 기반 관계 쿼리 구현

#### Task 108: 복잡한 관계 쿼리 구현
- [ ] N단계 관계 탐색 (친구의 친구 등)
- [ ] 최단 경로 찾기
- [ ] 관계 강도 계산 (PageRank, Centrality 등)

**예상 소요 시간**: 4시간

---

#### Task 109: 관계 그래프 시각화 개선
- [ ] Neo4j 데이터 기반 그래프 렌더링
- [ ] 동적 그래프 업데이트
- [ ] 관계 필터링 및 확대/축소

**예상 소요 시간**: 3시간

---

**Phase 9 예상 소요 시간**: 10-12시간

---

## Phase 10: 추가 기능 (지속적 개선)

### 목표
사용자 경험을 더욱 풍부하게 하는 추가 기능 구현

### 10.1 대사 음성 합성 (TTS)

#### Task 97: TTS API 연동
- [ ] TTS API 선택 (Google Cloud TTS, Amazon Polly, ElevenLabs 등)
- [ ] API 클라이언트 구현
- [ ] 대사 텍스트 → 음성 변환
- [ ] 음성 파일 저장 및 URL 반환

**예상 소요 시간**: 2시간

---

#### Task 97-1: 캐릭터별 음성 설정
- [ ] Character 엔티티에 voiceId 필드 추가
- [ ] 캐릭터별 음성 프로필 관리 UI
- [ ] 음성 미리듣기 기능

**예상 소요 시간**: 1시간

---

#### Task 97-2: 대사 읽기 기능 구현
- [ ] 대사 읽기 버튼 추가
- [ ] 오디오 플레이어 컴포넌트
- [ ] 재생/일시정지/중지 기능

**예상 소요 시간**: 1시간

---

**Task 97 총 예상 소요 시간**: 4시간

---

### 10.2 캐릭터 이미지 생성 (AI)

#### Task 98: 이미지 생성 API 연동
- [ ] 이미지 생성 API 선택 (DALL-E, Stable Diffusion, Midjourney API 등)
- [ ] API 클라이언트 구현
- [ ] 캐릭터 설명 → 프롬프트 생성
- [ ] 이미지 생성 및 URL 반환

**예상 소요 시간**: 2시간

---

#### Task 98-1: 캐릭터 이미지 저장 및 표시
- [ ] Character 엔티티에 imageUrl 필드 추가
- [ ] 이미지 생성 버튼 및 모달
- [ ] 생성된 이미지 미리보기
- [ ] 이미지 선택 및 저장

**예상 소요 시간**: 2시간

---

**Task 98 총 예상 소요 시간**: 4시간

---

### 10.3 플롯 구조 시각화

#### Task 99: 플롯 분석 및 시각화
- [ ] 기승전결 분석 로직 구현
  - 장면별 갈등 강도 추정
  - 스토리 아크 곡선 생성
- [ ] 타임라인 시각화 컴포넌트
  - 에피소드 및 장면 타임라인
  - 캐릭터별 등장 빈도 표시
- [ ] 에피소드 간 흐름 표시
  - Sankey 다이어그램 또는 플로우 차트
  - 캐릭터 관계 변화 추적

**예상 소요 시간**: 5시간

**기술 스택 제안**:
- D3.js 또는 Recharts (타임라인)
- React Flow (플로우 다이어그램)

---

### 10.4 엑셀/스프레드시트 가져오기/내보내기

#### Task 100: 엑셀 Import/Export
- [ ] 엑셀 라이브러리 추가 (Apache POI 또는 ExcelJS)
- [ ] 캐릭터 데이터 엑셀 가져오기
  - 엑셀 파일 파싱
  - 캐릭터 일괄 생성/업데이트
  - 유효성 검증 및 에러 처리
- [ ] 에피소드/장면 엑셀 내보내기
  - 에피소드 및 장면 데이터 엑셀 변환
  - 대사 포함 시나리오 엑셀 내보내기
  - 다운로드 기능 구현

**예상 소요 시간**: 3시간

**기능 상세**:
- Import: 엑셀 업로드 → 파싱 → 검증 → DB 저장
- Export: DB 조회 → 엑셀 생성 → 다운로드
- 템플릿 제공 (빈 엑셀 파일 다운로드)

---

**Phase 10 추가 기능 총 예상 소요 시간**: 16시간

---

## 🔧 알려진 이슈 및 개선 사항

### 1. Controller Test 실패 문제 (우선순위: 낮음)
**문제**: 42개 @WebMvcTest 실패 (ApplicationContext 로딩 문제)

**원인**:
- Spring Boot가 CacheAutoConfiguration을 로드하려고 시도
- Redis 연결 실패로 인한 컨텍스트 로딩 실패
- excludeAutoConfiguration으로도 완전히 해결되지 않음

**해결 방안 (향후)**:
- @WebMvcTest 대신 @SpringBootTest + @AutoConfigureMockMvc 사용 검토
- 또는 CacheConfig를 프로파일별로 완전히 분리
- TestContainers를 사용한 Redis 통합 테스트 환경 구축

**현재 상태**:
- 핵심 기능은 Integration/Service 테스트로 검증 완료
- 실제 동작에는 문제 없음 (159개 테스트 통과)
- Controller 레이어는 Integration 테스트로 충분히 커버됨

---

### 2. Neo4j 데이터 마이그레이션 (우선순위: 낮음)
**문제**: Neo4j 컨테이너는 실행 중이나 관계 데이터 미로드

**해결 방안**:
- Phase 9 진행 시 관계형 DB → Neo4j 마이그레이션 스크립트 작성
- 또는 현재 관계형 DB 방식 유지 (성능 문제 없음)

---

### 3. 프로덕션 데이터베이스 영속성 (우선순위: 중간)
**문제**: Docker 컨테이너 재시작 시 데이터 초기화 가능

**해결 방안**:
- docker-compose.yml에 볼륨 마운트 추가
- PostgreSQL 데이터 디렉터리 호스트에 마운트
- 백업 스크립트 작성

---

## 📋 작업 진행 시 권장 사항

### 우선순위별 작업 순서
1. **필수 개선 사항** (우선순위: 높음)
   - 프로덕션 데이터베이스 영속성 확보
   - 성능 모니터링 도구 도입 (선택적)

2. **사용자 경험 개선** (우선순위: 중간)
   - Task 97: TTS 기능 (대사 음성 합성)
   - Task 100: 엑셀 Import/Export (작가 워크플로 개선)

3. **고급 기능** (우선순위: 낮음)
   - Task 98: AI 이미지 생성
   - Task 99: 플롯 시각화
   - Phase 7: Vector DB 의미 검색
   - Phase 9: Neo4j GraphDB 전환

### 매 Task 완료 시
- [ ] 코드 커밋 (의미 있는 커밋 메시지)
- [ ] 테스트 실행 (빌드 에러 없는지)
- [ ] 이 문서의 체크박스 업데이트
- [ ] 실제 소요 시간 기록

### 코드 품질 유지
- 의미 있는 변수명 사용
- 주석은 "왜"에 집중
- 하나의 함수는 하나의 책임
- 테스트 작성 습관화

---

## 📊 전체 프로젝트 진행 상황

### 완료율
- **Phase 0-8**: 100% 완료 ✅
- **Phase 10**: 약 75% 완료 (Task 86-96 완료, Task 97-100 대기)
- **Phase 7, 9**: 0% (선택적, 미진행)

### 테스트 커버리지
- Service 계층: 79%
- Security 계층: 95%
- 전체: 67% (JaCoCo 기준)

### 주요 마일스톤
- ✅ 2025-10-15: Phase 0 완료 (프로젝트 초기 설정)
- ✅ 2025-10-20: Phase 1 완료 (도메인 모델 구축)
- ✅ 2025-10-22: Phase 3 완료 (LLM 연동)
- ✅ 2025-10-30: Phase 6 완료 (인증 시스템)
- ✅ 2025-11-03: Task 93 완료 (프론트엔드 최적화)
- ✅ 2025-11-04: Redis 테스트 환경 개선

---

## 🎯 다음 단계 제안

### 즉시 착수 가능한 작업
1. **프로덕션 DB 영속성 확보** (docker-compose.yml 볼륨 설정)
2. **Task 100: 엑셀 Import/Export** (작가 워크플로 개선)
3. **Task 97: TTS 기능** (사용자 경험 개선)

### 중장기 계획
1. **Controller Test 개선** (@WebMvcTest 설정 리팩토링)
2. **Phase 7: Vector DB** (의미 검색 기능)
3. **모니터링 시스템** (Prometheus, Grafana)

---

**프로젝트는 이미 매우 안정적이고 기능적입니다! 남은 작업은 모두 선택적 개선 사항입니다. 🎉**

**완료된 작업은 [COMPLETED_TASKS.md](COMPLETED_TASKS.md)를 참조하세요.**
